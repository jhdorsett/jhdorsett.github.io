<!DOCTYPE html>
<html lang=" en">
<head>
    <!-- MathJax -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
        </script>
    <link rel="stylesheet" href="/assets/css/style.css">
</head><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>BForStrain Strain Rate Inversion Code | Jake Dorsett</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="BForStrain Strain Rate Inversion Code" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Disagreements in Geodetically Inferred Strain Rates in the Western US With Stress Orientations and Geologic Moment Rates. Kaj M Johnson (2024)." />
<meta property="og:description" content="Disagreements in Geodetically Inferred Strain Rates in the Western US With Stress Orientations and Geologic Moment Rates. Kaj M Johnson (2024)." />
<link rel="canonical" href="http://localhost:4000/projects/bforstrain/" />
<meta property="og:url" content="http://localhost:4000/projects/bforstrain/" />
<meta property="og:site_name" content="Jake Dorsett" />
<meta property="og:image" content="http://localhost:4000/assets/images/BforStrain_US.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-05-15T15:31:59-04:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/images/BforStrain_US.png" />
<meta property="twitter:title" content="BForStrain Strain Rate Inversion Code" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-05-15T15:31:59-04:00","datePublished":"2025-05-15T15:31:59-04:00","description":"Disagreements in Geodetically Inferred Strain Rates in the Western US With Stress Orientations and Geologic Moment Rates. Kaj M Johnson (2024).","headline":"BForStrain Strain Rate Inversion Code","image":"http://localhost:4000/assets/images/BforStrain_US.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/projects/bforstrain/"},"url":"http://localhost:4000/projects/bforstrain/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Jake Dorsett" /></head>
<body><header class="site-header">

    <div class="wrapper"><a class="site-title" rel="author" href="/">Jake Dorsett</a><nav class="site-nav">
            <input type="checkbox" id="nav-trigger" class="nav-trigger" />
            <label for="nav-trigger">
                <span class="menu-icon">
                    <svg viewBox="0 0 18 15" width="18px" height="15px">
                        <path
                            d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z" />
                    </svg>
                </span>
            </label>

            <div class="trigger"><a class="page-link" href="/cv.html">CV</a><a class="page-link" href="/projects/">Projects</a></div>
        </nav></div>
</header><div class="banner">
    <img src="/assets/images/ambajejus_lake.jpg">
</div><main class="page-content" aria-label="Content">
        <div class="wrapper">
            <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">BForStrain Strain Rate Inversion Code</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2025-05-15T15:31:59-04:00" itemprop="datePublished">May 15, 2025
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><img src="/assets/images/BforStrain_US.png" alt="Your Photo" width="450" style="float:left; margin-right:15px;" /></p>

<p><a href="https://zenodo.org/badge/latestdoi/616755145"><img src="https://zenodo.org/badge/616755145.svg" alt="DOI" /></a></p>

<p>These codes compute strain rates on a trianglular 2D mesh using a geodetic velocity field. Body-forces in a thin elastic plate are used to compute a velocity and strain rate field computed at the centroids of the triangles in the mesh.  The inversion solves for the distribution of body forces (at the triangle nodes) that best-fits the geodetic velocity field.  You can specify a range of smoothing values (called beta) that minimize the magnitude of the body forces. There is also an optional second step that further minimizes strain rates below a specified threshold.</p>

<p>Parameters can be specified in params.py. The data used in <a href="https://doi.org/10.1029/2023JB027472">Johnson (2024)</a> from <a href="https://doi.org/10.1785/0220220180">Zeng (2022)</a> is currently loaded, along with creeping fault traces from the 2023 US National Seismic Hazard Model.</p>

<p>To run the demo, use the code below to download the repository and initialize a new environment</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/jhdorsett/BforStrain
cd BforStrain
conda env create -f environment.yml
conda activate BforStrain
</code></pre></div></div>

<p>Then the code can be executed with the data provided using <code class="language-plaintext highlighter-rouge">run.ipynb</code>.</p>

<p>Project structure:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>BforStrain
   | bForStrain.py
   |   |-- Mesh
   |   |   |-- create_gps_obs
   |   |   |-- create_creeping_segs
   |   |   |-- create_creeping_segs
   |   |   |-- crop
   |   |   |-- save
   |   |   |-- plotting_functions
   |   |   |-- coordinate_transforms
   |   |-- Inversion
   |   |   |-- bodyforce_greens_functions
   |   |   |-- creeping_greens_functions
   |   |   |-- prepare_inversion
   |   |   |-- invert
   |   |   |-- generate_uncertainty
   |   |   |-- post_process_results
   | disloc3d.py
   |   |-- dc3d
   |   |-- dc3d_wrapper
   | mesh2d.py
   |   |-- smooth2d
   |   |-- helper_functions
   | tools.py
   |   |-- helper_functions
   | data/
   |   |-- geodetic veolcities
   |   |-- creeping faults
   |   |-- coastline data (plotting)
</code></pre></div></div>

<p>Here is a particular model realization generated using the western US geodetic data and fault configuration. The mesh is colored by max shear strain rate in each triangle. Geodetic observations and modeled velocities are shown as vectors, where each data point is the average of all GPS stations in that triangle.</p>

<iframe src="/assets/src/bforstrain/bforstrain_maxshear.html" width="100%" height="500px"></iframe>

<p>This model is displaying the mean values for a suite run with three different damping parameters:</p>

\[{\chi}^2_{( {\beta}=35)} = 1.91
\\
{\chi}^2_{( {\beta}=40)} = 2.05
\\
{\chi}^2_{( {\beta}=45)} = 2.18\]

<p>Including pseudo-velocity data (some offshore vectors).</p>

  </div><a class="u-url" href="/projects/bforstrain/" hidden></a>
</article>

        </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Jake Dorsett</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Jake Dorsett</li><li><a class="u-email" href="mailto:jacob.h.dorsett@gmail.com">jacob.h.dorsett@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jhdosett"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jhdosett</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>I am a quantitative scientist working on geophysical, geospatial, and data science problems.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>